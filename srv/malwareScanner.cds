@protocol : 'none'
service malwareScanner {

  event ScanAttachmentsFile {
    target: String; //CSN name of Attachments entity to scan
    keys: Map; //Key value pairs of attachments entity to scan
  };

  action scan(file: LargeBinary) returns {
    isMalware: Boolean;
    encryptedContentDetected: Boolean;
    scanSize: Integer;
    finding: String;
    /**
     * Returns "empty" if no type could be detected
     */
    mimeType: String;
    /**
     * SHA256 hash of file
     */
    hash: String;
  }
}